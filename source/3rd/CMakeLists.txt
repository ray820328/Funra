CMAKE_MINIMUM_REQUIRED(VERSION 3.10)

SET(CMAKE_C_STANDARD 99)

SET(CMAKE_DEBUG_POSTFIX "d" CACHE STRING "Set debug librbased postfix" FORCE)
SET(CMAKE_RELEASE_POSTFIX "" CACHE STRING "Set release librbase postfix" FORCE)

PROJECT(3rd)

SET(R3RD_SOURCE_ROOT ${PROJECT_SOURCE_DIR})

IF (CMAKE_HOST_SYSTEM_NAME STREQUAL "Windows")
  SET(PROJECT_DEFINES "-DWIN32 -DOS_WIN -D_CRT_SECURE_NO_WARNINGS")
ELSEIF(CMAKE_HOST_SYSTEM_NAME STREQUAL "Linux")
  SET(PROJECT_DEFINES "-DOS_LINUX -D_OS_LINUX")
  SET(PROJECT_LINK_OPTIONS
    #-ljemalloc 
    -lm -lstdc++ -pthread -ldl
    -static-libgcc
    -static-libstdc++
  )
ELSE()
  MESSAGE(FATAL_ERROR "This operating system is not supported: ${CMAKE_HOST_SYSTEM_NAME}")
ENDIF()

ADD_DEFINITIONS(${PROJECT_DEFINES})
ADD_LINK_OPTIONS(${PROJECT_LINK_OPTIONS})

ADD_SUBDIRECTORY(cmocka)